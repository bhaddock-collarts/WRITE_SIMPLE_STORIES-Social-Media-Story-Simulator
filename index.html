import React, { useState } from 'react';
import { Play, RotateCcw, CheckCircle, XCircle, Zap, Eye, Share2, Heart } from 'lucide-react';

const SocialMediaStorySimulator = () => {
  const [currentStep, setCurrentStep] = useState(0);
  const [choices, setChoices] = useState({});
  const [score, setScore] = useState(0);
  const [showResults, setShowResults] = useState(false);

  const steps = [
    {
      id: 'hook',
      title: 'Choose Your Opening Hook',
      question: 'You have 1 second to stop the scroll. What do you start with?',
      options: [
        {
          text: 'Slow establishing shot of empty location',
          points: 0,
          feedback: 'Too slow! By the time viewers understand what they\'re looking at, they\'ve already scrolled past.',
          icon: XCircle
        },
        {
          text: 'Text overlay: "Wait for it..."',
          points: 3,
          feedback: 'Better! Creates curiosity, but make sure your payoff comes within 3 seconds or they\'ll keep scrolling.',
          icon: CheckCircle
        },
        {
          text: 'Striking visual + bold statement',
          points: 5,
          feedback: 'Excellent! You\'ve combined visual impact with instant intrigue. This stops the scroll immediately.',
          icon: CheckCircle
        },
        {
          text: 'Long introduction explaining context',
          points: 0,
          feedback: 'No time for this! Social media audiences make decisions in milliseconds. Get to the point instantly.',
          icon: XCircle
        }
      ]
    },
    {
      id: 'format',
      title: 'Choose Your Format',
      question: 'How will you present your story?',
      options: [
        {
          text: 'Horizontal video (cinematic)',
          points: 1,
          feedback: 'Not ideal. Horizontal video doesn\'t fill the mobile screen and feels out of place on TikTok/Reels.',
          icon: XCircle
        },
        {
          text: 'Vertical video (9:16 ratio)',
          points: 5,
          feedback: 'Perfect! Vertical video is designed for mobile viewing and takes up the full screen, maximizing engagement.',
          icon: CheckCircle
        },
        {
          text: 'Square video (1:1 ratio)',
          points: 2,
          feedback: 'Workable but not optimal. It doesn\'t fully utilize the mobile screen space that vertical video does.',
          icon: CheckCircle
        }
      ]
    },
    {
      id: 'aesthetic',
      title: 'Choose Your Production Style',
      question: 'What production approach will you use?',
      options: [
        {
          text: 'Highly polished studio production',
          points: 2,
          feedback: 'Careful! Too polished can feel inauthentic. Social media audiences often prefer genuine moments over perfection.',
          icon: XCircle
        },
        {
          text: 'Raw, authentic phone footage',
          points: 5,
          feedback: 'Excellent! Authenticity beats perfection on social platforms. Real moments create stronger connections.',
          icon: CheckCircle
        },
        {
          text: 'Mix of authentic moments with trending effects',
          points: 4,
          feedback: 'Great balance! You\'re authentic but still speaking the visual language of the platform.',
          icon: CheckCircle
        }
      ]
    },
    {
      id: 'text',
      title: 'Text Overlay Strategy',
      question: 'How will you use text overlays?',
      options: [
        {
          text: 'No text - let the video speak',
          points: 2,
          feedback: 'Risky. Text overlays help when audio is off and add emphasis. Many viewers scroll with sound muted.',
          icon: XCircle
        },
        {
          text: 'Key words for emphasis and context',
          points: 5,
          feedback: 'Perfect! Text overlays enhance understanding, work when muted, and add visual interest.',
          icon: CheckCircle
        },
        {
          text: 'Entire script written on screen',
          points: 1,
          feedback: 'Too much! Overwhelming text creates cognitive overload. Keep it punchy and scannable.',
          icon: XCircle
        }
      ]
    },
    {
      id: 'shareability',
      title: 'Final Touch',
      question: 'What makes your story shareable?',
      options: [
        {
          text: 'Inside jokes only your friends get',
          points: 2,
          feedback: 'Limited reach. Too niche means fewer shares. Find universal relatability within specific moments.',
          icon: XCircle
        },
        {
          text: 'Relatable moment everyone recognizes',
          points: 5,
          feedback: 'Excellent! Universal relatability drives shares. People send content that makes them say "this is so me!"',
          icon: CheckCircle
        },
        {
          text: 'Surprise twist or unexpected reveal',
          points: 5,
          feedback: 'Great! People love sharing content that surprised them. The "wait, watch this" factor drives engagement.',
          icon: CheckCircle
        },
        {
          text: 'Call to action to follow for more',
          points: 1,
          feedback: 'Not enough! Before asking for follows, give value. Make them want to share first, then they\'ll follow.',
          icon: XCircle
        }
      ]
    }
  ];

  const handleChoice = (stepIndex, optionIndex) => {
    const selectedOption = steps[stepIndex].options[optionIndex];
    const newChoices = { ...choices, [steps[stepIndex].id]: selectedOption };
    setChoices(newChoices);
    setScore(score + selectedOption.points);

    if (stepIndex === steps.length - 1) {
      setShowResults(true);
    } else {
      setTimeout(() => setCurrentStep(stepIndex + 1), 1500);
    }
  };

  const reset = () => {
    setCurrentStep(0);
    setChoices({});
    setScore(0);
    setShowResults(false);
  };

  const getGrade = () => {
    const percentage = (score / 25) * 100;
    if (percentage >= 90) return { grade: 'A', message: 'Viral Potential!', color: 'text-green-500' };
    if (percentage >= 75) return { grade: 'B', message: 'Strong Engagement', color: 'text-blue-500' };
    if (percentage >= 60) return { grade: 'C', message: 'Room for Improvement', color: 'text-yellow-500' };
    return { grade: 'D', message: 'Needs Work', color: 'text-red-500' };
  };

  if (showResults) {
    const result = getGrade();
    return (
      <div className="min-h-screen bg-gradient-to-br from-purple-900 via-pink-900 to-orange-900 p-4 flex items-center justify-center">
        <div className="max-w-2xl w-full bg-black bg-opacity-50 backdrop-blur-lg rounded-3xl p-8 text-white">
          <h2 className="text-4xl font-bold mb-6 text-center">Your Story Performance</h2>
          
          <div className="text-center mb-8">
            <div className={`text-8xl font-bold mb-4 ${result.color}`}>{result.grade}</div>
            <div className="text-2xl font-semibold mb-2">{result.message}</div>
            <div className="text-4xl font-bold text-purple-300">{score}/25 points</div>
          </div>

          <div className="bg-gray-900 bg-opacity-50 rounded-2xl p-6 mb-6">
            <h3 className="text-xl font-bold mb-4 flex items-center gap-2">
              <Zap className="text-yellow-400" /> Key Insights
            </h3>
            <div className="space-y-4">
              {Object.entries(choices).map(([key, choice]) => {
                const Icon = choice.icon;
                return (
                  <div key={key} className="border-l-4 border-purple-500 pl-4 py-2">
                    <div className="flex items-start gap-2 mb-1">
                      <Icon className={`w-5 h-5 flex-shrink-0 mt-1 ${choice.points >= 4 ? 'text-green-400' : 'text-red-400'}`} />
                      <div className="font-semibold">{choice.text}</div>
                    </div>
                    <p className="text-gray-300 text-sm">{choice.feedback}</p>
                  </div>
                );
              })}
            </div>
          </div>

          <div className="bg-purple-900 bg-opacity-50 rounded-2xl p-6 mb-6">
            <h3 className="text-xl font-bold mb-3">Remember:</h3>
            <ul className="space-y-2 text-gray-200">
              <li className="flex items-start gap-2">
                <Eye className="w-5 h-5 text-pink-400 flex-shrink-0 mt-1" />
                <span>First second is critical - hook immediately or lose them</span>
              </li>
              <li className="flex items-start gap-2">
                <Heart className="w-5 h-5 text-pink-400 flex-shrink-0 mt-1" />
                <span>Authenticity beats perfection on social platforms</span>
              </li>
              <li className="flex items-start gap-2">
                <Share2 className="w-5 h-5 text-pink-400 flex-shrink-0 mt-1" />
                <span>Shareability is the ultimate metric of success</span>
              </li>
            </ul>
          </div>

          <button
            onClick={reset}
            className="w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white font-bold py-4 px-6 rounded-xl transition-all flex items-center justify-center gap-2 text-lg"
          >
            <RotateCcw className="w-6 h-6" />
            Try Different Choices
          </button>
        </div>
      </div>
    );
  }

  const step = steps[currentStep];
  const selectedChoice = choices[step.id];

  return (
    <div className="min-h-screen bg-gradient-to-br from-purple-900 via-pink-900 to-orange-900 p-4">
      <div className="max-w-4xl mx-auto">
        <div className="bg-black bg-opacity-50 backdrop-blur-lg rounded-3xl p-6 mb-6 text-white">
          <div className="flex items-center justify-between mb-4">
            <h1 className="text-2xl font-bold flex items-center gap-2">
              <Play className="text-pink-400" />
              Social Media Story Simulator
            </h1>
            <div className="text-xl font-bold text-purple-300">
              {score} pts
            </div>
          </div>
          
          <div className="flex gap-2 mb-4">
            {steps.map((s, idx) => (
              <div
                key={s.id}
                className={`h-2 flex-1 rounded-full transition-all ${
                  idx < currentStep
                    ? 'bg-green-500'
                    : idx === currentStep
                    ? 'bg-purple-500'
                    : 'bg-gray-700'
                }`}
              />
            ))}
          </div>

          <div className="text-sm text-gray-400 mb-2">
            Step {currentStep + 1} of {steps.length}
          </div>
        </div>

        <div className="bg-black bg-opacity-50 backdrop-blur-lg rounded-3xl p-8 text-white">
          <h2 className="text-3xl font-bold mb-3">{step.title}</h2>
          <p className="text-xl text-gray-300 mb-8">{step.question}</p>

          <div className="space-y-4">
            {step.options.map((option, idx) => (
              <button
                key={idx}
                onClick={() => !selectedChoice && handleChoice(currentStep, idx)}
                disabled={!!selectedChoice}
                className={`w-full text-left p-6 rounded-2xl transition-all transform hover:scale-[1.02] ${
                  selectedChoice === option
                    ? option.points >= 4
                      ? 'bg-green-600 ring-4 ring-green-400'
                      : 'bg-red-600 ring-4 ring-red-400'
                    : selectedChoice
                    ? 'bg-gray-800 opacity-50'
                    : 'bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500'
                }`}
              >
                <div className="font-semibold text-lg mb-2">{option.text}</div>
                {selectedChoice === option && (
                  <div className="text-sm mt-3 pt-3 border-t border-white border-opacity-30">
                    {option.feedback}
                  </div>
                )}
              </button>
            ))}
          </div>

          {selectedChoice && (
            <div className="mt-6 text-center">
              <div className="inline-flex items-center gap-2 bg-purple-600 bg-opacity-50 px-6 py-3 rounded-full">
                <Zap className="text-yellow-400" />
                <span className="font-semibold">
                  {currentStep < steps.length - 1 ? 'Moving to next step...' : 'Calculating results...'}
                </span>
              </div>
            </div>
          )}
        </div>
      </div>
    </div>
  );
};

export default SocialMediaStorySimulator;
